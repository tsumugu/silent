# Feature 02: メニーバー・常駐モード (Tray)

メニューバーに常駐し、再生状態の匂わせやウィンドウへの入り口としての役割を果たします。

## 実装内容

### 1. TrayManager の作成 (`src/main/services/TrayManager.ts`)
- `nativeImage` を使用して、状態に応じた Tray アイコン（テンプレート画像）を表示します。
- `tray.setTitle()` を使用して、再生中の「なうぷれ」情報を表示します。
- **アニメーション**: `setInterval` またはタイマーを使用して、アイコンの opacity や線幅（複数の画像を切り替える等）を変化させます。

### 2. ウィンドウ表示ロジック
- Tray アイコンをクリックした際、アイコンの真下に `UIWindow` を表示します。
- `tray.getBounds()` を取得し、ウィンドウの `x`, `y` 座標を計算します。
- フォーカスが外れた際にウィンドウを隠すオプション（`blur` イベント）の検討。

### 3. コンテキストメニュー
- 右クリック（または特定の操作）で、「Preferences」「Quit」などの基本操作にアクセスできるようにします。

## 技術的ポイント
- **Now Playing 表示**: 領域を圧迫するため、以下の工夫をします。
    - **スクロール実装**: 曲名が長い場合、`setInterval` を使用してタイトル文字列を 1 文字ずつずらして更新し、流れる文字（Marquee）を実現します。
    - **設定**: スクロールの有無、表示の有無を `SettingsService` で切り替え可能にします。
- **再起動**: `displayMode` の変更時はアプリの再起動を促し、`app.relaunch()` を実行します。
